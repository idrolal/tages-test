import{d as h,i as S,c as r,o as s,j as m,b as o,t as d,k as V,l as z,F as w,e as x,f as B,C as N,w as L,g as y,n as I,_ as C,m as F,p as J,q as K,v as O,s as j,A as $,x as P,y as U,z as A,u as v}from"./index-CI8E5huV.js";const D=["width","height","fill"],E={key:0},R=["href"],k=h({__name:"Icon",props:{icon:{},size:{default:()=>["1em","1em"]},color:{},title:{}},setup(c){const e=c,t=S(()=>`/images/svg/sprites.svg#${e.icon}`);return(_,i)=>(s(),r("svg",{width:e.size&&e.size[0],height:e.size&&e.size[1],fill:e.color&&e.color},[e.title?(s(),r("title",E,d(e.title),1)):m("",!0),o("use",{href:t.value},null,8,R)],8,D))}}),q={key:0,class:"category-card__content"},T={class:"category-card__item-header"},G={key:0,class:"category-card__item-sale"},H=["src","alt"],Q={class:"category-card__item-footer"},W={class:"category-card__item-info"},X={key:0,class:"category-card__item-code"},Y={class:"category-card__item-name"},Z={class:"category-card__item-prices"},ee={key:0,class:"category-card__item-price category-card__item-price--old"},te={class:"category-card__item-price"},ae={class:"category-card__item-actions"},se={key:1},oe=h({__name:"CategoryCard",props:{categoryItems:{default:()=>[]},loading:{type:Boolean,default:!0},name:{}},setup(c){const e=c,t=V({favorites:{},cart:{}}),_=n=>{t.favorites[n]=!t.favorites[n],localStorage.setItem(`${e.name}-favorites`,JSON.stringify(t.favorites))},i=n=>{t.cart[n]=!t.cart[n],localStorage.setItem(`${e.name}-cart`,JSON.stringify(t.cart))};return z(()=>{t.favorites=JSON.parse(localStorage.getItem(`${e.name}-favorites`)||"{}"),t.cart=JSON.parse(localStorage.getItem(`${e.name}-cart`)||"{}")}),(n,u)=>!e.loading&&e.categoryItems.length?(s(),r("div",q,[(s(!0),r(w,null,x(e.categoryItems,a=>(s(),B(N,{key:a.id,class:"category-card__item"},{default:L(()=>[o("div",T,[a.price.old_price?(s(),r("span",G,"Скидка")):m("",!0),o("img",{src:a.image.url,width:"238px",height:"238px",alt:a.name},null,8,H)]),o("div",Q,[o("div",W,[a.code?(s(),r("span",X,d(a.code),1)):m("",!0),o("p",Y,d(a.name),1),o("div",Z,[a.price.old_price?(s(),r("p",ee,d(a.price.old_price.toFixed(0))+"₽ ",1)):m("",!0),o("p",te,d(a.price.current_price.toFixed(0))+"₽ ",1)])]),o("div",ae,[y(k,{icon:t.cart[a.id]?"ok":"cart",size:["20px","20px"],class:I({"category-card__action":!0,"category-card__action-in-cart":t.cart[a.id]}),onClick:l=>i(a.id)},null,8,["icon","class","onClick"]),y(k,{icon:"heart",size:["20px","20px"],class:I({"category-card__action":!0,"category-card__action-favorite":t.favorites[a.id]}),onClick:l=>_(a.id)},null,8,["class","onClick"])])])]),_:2},1024))),128))])):(s(),r("div",se,"loading"))}}),re=C(oe,[["__scopeId","data-v-62d6add8"]]),ce={class:"select"},le={class:"select-wrapper"},ie={key:0,class:"select-placeholder"},ne=["value"],de=h({__name:"CustomSelect",props:F({items:{default:()=>[]},optionsKey:{default:"id"},optionsLabel:{},label:{default:""},placeholder:{default:""},clearble:{type:Boolean,default:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const e=c,t=J(c,"modelValue"),_=()=>{e.clearble&&(t.value=null)};return(i,n)=>(s(),r("div",ce,[o("label",null,d(i.label),1),o("div",le,[t.value?m("",!0):(s(),r("p",ie,d(i.placeholder),1)),K(o("select",{"onUpdate:modelValue":n[0]||(n[0]=u=>t.value=u)},[(s(!0),r(w,null,x(i.items,(u,a)=>(s(),r("option",{key:a,value:u[i.optionsKey]},d(u[i.optionsLabel]),9,ne))),128))],512),[[O,t.value]]),i.clearble?(s(),r("p",{key:1,class:"select-close",onClick:_},"×")):m("",!0)])]))}}),b=C(de,[["__scopeId","data-v-8869737a"]]),_e=j("categoriesStore",{state:()=>({categoryItems:[],materials:[],errorCategoryItems:void 0,errorMaterials:void 0}),actions:{async getCategoryItems(c){var e;try{const{data:t}=await this.$api.get(`/data/${c}.json`);this.categoryItems=t,this.errorCategoryItems=void 0}catch(t){t instanceof $&&(this.errorCategoryItems=(e=t.response)==null?void 0:e.data.message)}},async getMaterials(){var c;if(!this.materials.length)try{const{data:e}=await this.$api.get("/data/materials.json");this.materials=e,this.errorMaterials=void 0}catch(e){e instanceof $&&(this.errorMaterials=(c=e.response)==null?void 0:c.data.message)}}}}),ue={class:"category-page"},pe={class:"category-page_filters"},me=h({__name:"CategoryPage",setup(c){const e=[{value:"asc",label:"Цена по возрастанию"},{value:"desc",label:"Цена по убыванию"}],t=A(),_=_e(),{getCategoryItems:i,getMaterials:n}=_,{categoryItems:u,materials:a}=P(_),l=V({loading:!0,sort:null,material:null}),M=S(()=>u.value.filter(g=>l.material?g.material===+l.material:!0).sort((g,p)=>l.sort==="asc"?g.price.current_price-p.price.current_price:l.sort==="desc"?p.price.current_price-g.price.current_price:0));return U(async()=>{await n(),await i(t.params.name),l.loading=!1}),(g,p)=>(s(),r("section",ue,[o("h1",null,d(v(t).params.name),1),o("div",pe,[y(b,{items:e,label:"Сортировать по",optionsKey:"value",optionsLabel:"label",placeholder:"Выберите сортировку",modelValue:l.sort,"onUpdate:modelValue":p[0]||(p[0]=f=>l.sort=f)},null,8,["modelValue"]),y(b,{items:v(a),label:"Материал",optionsKey:"id",optionsLabel:"name",placeholder:"Выберите материал",modelValue:l.material,"onUpdate:modelValue":p[1]||(p[1]=f=>l.material=f)},null,8,["items","modelValue"])]),y(re,{categoryItems:M.value,loading:l.loading,name:v(t).params.name},null,8,["categoryItems","loading","name"])]))}}),ye=C(me,[["__scopeId","data-v-89d5b5fb"]]);export{ye as default};
